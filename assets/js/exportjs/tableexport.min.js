/*!
 * TableExport.js v3.0.0 (http://www.clarketravis.com)
 * Copyright 2015 Travis Clarke
 * Licensed under the MIT license
 */
;(function(a,c){var b=a.jQuery;b.fn.tableExport=function(f){var g=b.extend({},b.fn.tableExport.defaults,f),i=b.fn.tableExport.rowDel,h,d,e;if(g.bootstrap){h=b.fn.tableExport.bootstrap[0]+" ";d=b.fn.tableExport.bootstrap[1]+" ";e=b.fn.tableExport.bootstrap[2]+" "}else{h=b.fn.tableExport.defaultButton+" ";d=e=""}return this.each(function(){var n=b(this),l=g.headings?n.find("tr"):n.find("tr:has(td)"),q=g.fileName==="id"?(n.attr("id")?n.attr("id"):b.fn.tableExport.defaultFileName):g.fileName,o={xlsx:function(w,r){var x=l.map(function(z,A){var y=b(A).find("th, td");return y.map(function(B,C){return b(C).text()})}).get(),v=JSON.stringify({data:x,name:r}),u=r+".xlsx",t=b.fn.tableExport.xlsx.buttonContent,s=b.fn.tableExport.xlsx.defaultClass;p(v,u,t,s)},xls:function(s,t){var r=b.fn.tableExport.xls.separator,x="data:application/vnd.ms-excel;charset=utf-16,"+encodeURIComponent(l.map(function(z,A){var y=b(A).find("th, td");return y.map(function(B,C){return b(C).html()}).get().join(r)}).get().join(s)),w=t+".xls",v=b.fn.tableExport.xls.buttonContent,u=b.fn.tableExport.xls.defaultClass;j(x,w,v,u)},csv:function(s,t){s='"'+s+'"';var r='"'+b.fn.tableExport.csv.separator+'"',x="data:text/csv;charset=utf-16,"+encodeURIComponent('"'+l.map(function(z,A){var y=b(A).find("th, td");return y.map(function(B,C){return b(C).text().replace(/"/g,'""')}).get().join(r)}).get().join(s)+'"'),w=t+".csv",v=b.fn.tableExport.csv.buttonContent,u=b.fn.tableExport.csv.defaultClass;j(x,w,v,u)},txt:function(s,t){var r=b.fn.tableExport.txt.separator,x="data:text/plain;charset=utf-16,"+encodeURIComponent(l.map(function(z,A){var y=b(A).find("th, td");return y.map(function(B,C){return b(C).text()}).get().join(r)}).get().join(s)),w=t+".txt",v=b.fn.tableExport.txt.buttonContent,u=b.fn.tableExport.txt.defaultClass;j(x,w,v,u)}};g.formats.forEach(function(r){o[r](i,q)});function k(r){var s=n.find("caption:not(.head)");s.length?s.append(r):n.prepend('<caption class="'+e+g.position+'">'+r+"</caption>")}function j(v,t,s,r){var u="<a href='"+v+"' download='"+t+"' role='button' class='"+h+d+r+"'>"+s+"</a>";k(u)}function p(u,t,s,r){var v="<a href='#' data-obj='"+u+"' download='"+t+"' role='button' class='"+h+d+r+"'>"+s+"</a>";k(v);m(r)}function m(s){var r="."+s;return b(r).on("click",function(v){if(b(this).data("obj")){v.preventDefault();var t=b(this).data("obj"),u=t.data,w=t.name;export2xlsx(u,w)}})}})};b.fn.tableExport.defaults={headings:true,formats:["xls","csv","txt"],fileName:"id",bootstrap:true,position:"bottom"};b.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx"};b.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t"};b.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:","};b.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  "};b.fn.tableExport.defaultFileName="myDownload";b.fn.tableExport.defaultButton="button-default";b.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"];b.fn.tableExport.rowDel="\r\n"}(window));function dateNum(b,a){if(a){b+=1462}var c=Date.parse(b);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function createSheet(g,f){var b={};var c={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var e=0;e!=g.length;++e){for(var h=0;h!=g[e].length;++h){if(c.s.r>e){c.s.r=e}if(c.s.c>h){c.s.c=h}if(c.e.r<e){c.e.r=e}if(c.e.c<h){c.e.c=h}var a={v:g[e][h]};if(a.v==null){continue}var d=XLSX.utils.encode_cell({c:h,r:e});if(typeof a.v==="number"){a.t="n"}else{if(typeof a.v==="boolean"){a.t="b"}else{if(a.v instanceof Date){a.t="n";a.z=XLSX.SSF._table[14];a.v=dateNum(a.v)}else{a.t="s"}}}b[d]=a}}if(c.s.c<10000000){b["!ref"]=XLSX.utils.encode_range(c)}return b}function Workbook(){if(!(this instanceof Workbook)){return new Workbook()}this.SheetNames=[];this.Sheets={}}function string2ArrayBuffer(d){var b=new ArrayBuffer(d.length);var a=new Uint8Array(b);for(var c=0;c!=d.length;++c){a[c]=d.charCodeAt(c)&255}return b}function export2xlsx(f,b){var e=new Workbook(),a=createSheet(f);e.SheetNames.push(b);e.Sheets[b]=a;var d={bookType:"xlsx",bookSST:false,type:"binary"};var c=XLSX.write(e,d);saveAs(new Blob([string2ArrayBuffer(c)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),b+".xlsx")};